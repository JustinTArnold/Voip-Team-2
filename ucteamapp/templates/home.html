<!DOCTYPE html>
<html lang="en-US">
	<head>
		{% load static %}
		<link rel='stylesheet' href="{% static 'css/style.css' %}">
		<script src="http://d3js.org/d3.v3.min.js"></script>
		<!-- script for the pie chart -->
		<script type="text/javascript" src="{% static 'js/chartjs/package/dist/chart.js' %}"></script>
	</head>
    <!-- the sidebar -->
	<body style ="background-image: url('https://th.bing.com/th/id/Re1139e26555d9325b5df67c5efa72912?rik=b9s%2bUh5aST9%2fTw&riu=http%3a%2f%2fgetwallpapers.com%2fwallpaper%2ffull%2f9%2f1%2fe%2f168436.jpg&ehk=8B7XoAxEElKs6vly5bZsGVBS6IOIMPPs2ajLohzvt3s%3d&risl=&pid=ImgRaw');background-repeat: no-repeat;background-attachment: fixed;background-size: cover; padding: 0; margin: 0;">
		<div class="sidebar">
		    <a class="active" href="/home">Home</a>
		    <a href="/inventory">Inventory</a>
		    <a href="#did">DID Database</a>
		    <a href="#did">CER / 911</a>
		    <a href="#did">Admin</a>
		    {% if user.is_authenticated %}
		    	<a href="{% url 'logout' %}">Log Out</a>
		    {% else %}
		    	<a href="/accounts/login">Log In</a>
		    {% endif %}
		    <div style="position: absolute;bottom:0%;left:50%;transform: translate(-50%,0%);">
			  	{% if user.is_authenticated %}
			  		<img src='{% static "assets/user_profile_picture/"|add:user.username|add:".png" %}' height="100px" width="100px">
			  		<p style="color:white;white-space:nowrap;">{{ user.get_full_name }}</p>
			  	{% else %}
			    	<img src="https://i.imgur.com/2nLLtVN.png" height="100px" width="100px">
			    	<p style="color:white; white-space:nowrap;">Not Logged In</p>
	  			{% endif %}
		  	</div>
		</div>
		{% if user.is_authenticated %}
		<div class="dropshadowimg" style="background-color:#363636; height:475px; width:400px;transform: translate(-50%, -50%);position: fixed; left: 25%;top: 30%; ">
			<canvas id="myChart" width="400" height="450"></canvas>
			<script>
			const models = {
			  7841: 1,
			  8811: 1,
			  8851: 1
			}

			d3.csv('{% static "assets/csv/phones.csv" %}', data => {
			    for(const entry of data) {
			    	console.log(entry.Model);
			    	if(models[entry.Model]) {
			    		models[entry.Model]++;
			    	}
			    }
			var ctx = document.getElementById('myChart');
			var myChart = new Chart(ctx, {
			    type: 'doughnut',
			    data: {
			        labels: ['Cisco 7841', 'Cisco 8811', 'Cisco 8851'],
			        datasets: [{
			            label: '# of Phones',
			            data:  [models['7841']-1 , models['8811']-1, models['8851']-1],
			            backgroundColor: [
			                'rgba(255, 99, 132, 0.2)',
			                'rgba(54, 162, 235, 0.2)',
			                'rgba(255, 206, 86, 0.2)'
			            ],
			            borderColor: [
			                'rgba(255, 99, 132, 1)',
			                'rgba(54, 162, 235, 1)',
			                'rgba(255, 206, 86, 1)'
			            ],
			            borderWidth: 2,
			            hoverOffset: 2
			        }]
			    },
			});
			});
			</script>
			<h2 style="color:white;"><center> Phone Inventory </center></h2>
		</div>
		{% else %}
            <div class="dropshadowimg" style="background-color:#363636; height:120px; width:400px;transform: translate(-50%, -50%);position: absolute; left: 55%;top: 45%; ">   
                <h1 style="color:red;"><center>ACCESS DENIED</center></h1>
                <a  href="/accounts/login">
                    <center>
                            <button>Go to Log In</button>
                    </center>
                </a>
            </div>
        {% endif %}
	</body>
</html>